{"version":3,"file":"index.ae793f44.js","sources":["../../node_modules/@ant-design/icons-svg/es/asn/ReconciliationOutlined.js","../../node_modules/@ant-design/icons/es/icons/ReconciliationOutlined.js","../../src/api/permit/index.js","../../src/routes/booking/index.jsx"],"sourcesContent":["// This icon file is generated automatically.\nvar ReconciliationOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M676 565c-50.8 0-92 41.2-92 92s41.2 92 92 92 92-41.2 92-92-41.2-92-92-92zm0 126c-18.8 0-34-15.2-34-34s15.2-34 34-34 34 15.2 34 34-15.2 34-34 34zm204-523H668c0-30.9-25.1-56-56-56h-80c-30.9 0-56 25.1-56 56H264c-17.7 0-32 14.3-32 32v200h-88c-17.7 0-32 14.3-32 32v448c0 17.7 14.3 32 32 32h336c17.7 0 32-14.3 32-32v-16h368c17.7 0 32-14.3 32-32V200c0-17.7-14.3-32-32-32zm-412 64h72v-56h64v56h72v48H468v-48zm-20 616H176V616h272v232zm0-296H176v-88h272v88zm392 240H512V432c0-17.7-14.3-32-32-32H304V240h100v104h336V240h100v552zM704 408v96c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-96c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zM592 512h48c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8z\" } }] }, \"name\": \"reconciliation\", \"theme\": \"outlined\" };\nexport default ReconciliationOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ReconciliationOutlinedSvg from \"@ant-design/icons-svg/es/asn/ReconciliationOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar ReconciliationOutlined = function ReconciliationOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: ReconciliationOutlinedSvg\n  }));\n};\n\nReconciliationOutlined.displayName = 'ReconciliationOutlined';\nexport default /*#__PURE__*/React.forwardRef(ReconciliationOutlined);","import req from \"../../util/request\"\r\n\r\nexport default {\r\n  get: (id) => req.get(`permit/${id}`),\r\n  getList: (params, cancelToken) => req.get('permit/list', { params, cancelToken }),\r\n};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Table, Card, Select } from 'antd';\r\nimport {\r\n  ReconciliationOutlined,\r\n} from \"@ant-design/icons\";\r\nimport dayjs from 'dayjs';\r\n\r\nimport api from '../../api/permit';\r\nimport adminApi from '../../api/admin';\r\nimport useListPage from '../../hook/useListPage';\r\nimport { buildFilter, buildTimeRangeFilter } from '../../components/Table/tableHelp';\r\nimport useSearchColumn from '../../hook/useSearchColumn';\r\nimport IntlMessages from \"../../util/IntlMessages\";\r\nimport { StyledLink } from '../../components/styled/operateBtns';\r\n\r\nconst PermitStatus = {\r\n  0: 'WaitForCheck', // 等待Checking\r\n  1: 'Checking', // 当前状态可check in\r\n  2: 'Waiting', // 等待取车/入場(Permit為 Visitor時)\r\n  3: 'WaitForOut', // 用户已填写当前电量与里程数\r\n  4: 'Outing', // 已出场\r\n  // 5: 'In', //车辆已入场(Visitor時)\r\n  6: 'Done', //已完成\r\n  7: 'Abnormal', //當車輛超出Permit active to未入場還車，狀態則爲異常\r\n  8: 'Expired', //已過期\r\n};\r\n\r\n/**@return {import('../../../components/tableHelp').buildDrodown} */\r\nconst buildStatusSelect =\r\n  () =>\r\n    ({ selectedKeys, setSelectedKeys, confirm }) => {\r\n      return (\r\n        <Select\r\n          options={[{ label: \"WaitForCheck\", value: \"0\" }, { label: \"Checking\", value: \"1\" }, { label: \"Waiting\", value: \"2\" }, { label: \"WaitForOut\", value: \"3\" }, { label: \"Outing\", value: \"4\" }, { label: \"Done\", value: \"6\" }, { label: \"Abnormal\", value: \"7\" }, { label: \"Expired\", value: \"8\" }]}\r\n          style={{ width: '100%' }}\r\n          value={selectedKeys}\r\n          onSelect={v => {\r\n            setSelectedKeys([v]);\r\n            confirm();\r\n          }}\r\n          placeholder='Click to select'\r\n        />\r\n      );\r\n    };\r\n\r\n/**@return {import('../../../components/tableHelp').buildDrodown} */\r\nconst buildAdminSelect =\r\n  defo =>\r\n    ({ selectedKeys, setSelectedKeys, confirm }) => {\r\n      return (\r\n        <Select\r\n          options={defo}\r\n          style={{ width: '100%' }}\r\n          value={selectedKeys}\r\n          onSelect={v => {\r\n            setSelectedKeys([v]);\r\n            confirm();\r\n          }}\r\n          placeholder='Click to select'\r\n        />\r\n      );\r\n    };\r\n\r\nconst Booking = () => {\r\n  const { dataState, handleTableChange, cachedParams } = useListPage(api);\r\n  const [adminOptions, setAdminOptions] = useState([]);\r\n  useEffect(() => {\r\n    adminApi\r\n      .getOptions()\r\n      .then(res => setAdminOptions(res))\r\n  }, [])\r\n  console.log(cachedParams[\"sort\"])\r\n  /**@type {import('antd/lib/table').ColumnsType} */\r\n  const columns = [\r\n    {\r\n      title: <IntlMessages id='table.operation' />,\r\n      dataIndex: 'sort',\r\n      key: 'operation',\r\n      render: (_, data) => {\r\n        return (\r\n          <div style={{ display: 'flex' }}>\r\n            {(!data.vehicleId && (data.status === 0 || data.status === 1)) ? (\r\n              <StyledLink\r\n                to={{ pathname: \"spare\", state: { permitId: data._id } }}\r\n              >\r\n                <ReconciliationOutlined />\r\n              </StyledLink>\r\n            ) : null}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: <IntlMessages id='vehicle.licenceNumber' />,\r\n      dataIndex: 'licenceNumber',\r\n      key: '~licenceNumber',\r\n\r\n      filteredValue: cachedParams['~licenceNumber'],\r\n      ...useSearchColumn('licenceNumber'),\r\n    },\r\n    {\r\n      title: <IntlMessages id='admin.name' />,\r\n      dataIndex: ['admin', 'name'],\r\n      key: 'adminId',\r\n      // render: v => <Tag>{v}</Tag>,\r\n      filteredValue: cachedParams.adminId,\r\n      ...buildFilter(buildAdminSelect(adminOptions)),\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.carType' />,\r\n      dataIndex: ['booking', 'carType'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.purpose' />,\r\n      dataIndex: ['booking', 'purpose'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.timeFrom' />,\r\n      dataIndex: ['booking', 'timeFrom'],\r\n      key: '#timeFrom',\r\n      render: (timeFrom) => dayjs(timeFrom).format('YYYY-MM-DD HH:mm'),\r\n      filteredValue: cachedParams['#timeFrom'],\r\n      ...buildTimeRangeFilter(),\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.timeTo' />,\r\n      dataIndex: ['booking', 'timeTo'],\r\n      key: '#timeTo',\r\n      render: (timeTo) => dayjs(timeTo).format('YYYY-MM-DD HH:mm'),\r\n      filteredValue: cachedParams['#timeTo'],\r\n      ...buildTimeRangeFilter(),\r\n    },\r\n    {\r\n      title: <IntlMessages id='vehicle.status' />,\r\n      dataIndex: ['status'],\r\n      render: v => PermitStatus[v],\r\n      filteredValue: cachedParams['status'],\r\n      ...buildFilter(buildStatusSelect()),\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.passenger' />,\r\n      dataIndex: ['booking', 'passenger'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.beforSOC' />,\r\n      dataIndex: ['booking', 'beforSOC'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.afterSOC' />,\r\n      dataIndex: ['booking', 'afterSOC'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.beforTotalMileage' />,\r\n      dataIndex: ['booking', 'beforTotalMileage'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.afterTotalMileage' />,\r\n      dataIndex: ['booking', 'afterTotalMileage'],\r\n    },\r\n    {\r\n      title: <IntlMessages id='booking.remark' />,\r\n      dataIndex: ['booking', 'remark'],\r\n    }\r\n  ];\r\n\r\n  return <Card title={<IntlMessages id='table.list' values={{ menu: 'Booking' }} />}>\r\n    <Table\r\n      {...dataState}\r\n      className=\"gx-table-responsive\"\r\n      columns={columns}\r\n      rowKey='_id'\r\n      onChange={handleTableChange}\r\n    />\r\n  </Card>\r\n}\r\n\r\nexport default Booking;"],"names":["ReconciliationOutlined","React.createElement","_objectSpread","React.forwardRef","get","id","req","getList","params","cancelToken","PermitStatus","buildStatusSelect","selectedKeys","setSelectedKeys","confirm","label","value","width","v","buildAdminSelect","defo","Booking","dataState","handleTableChange","cachedParams","useListPage","api","adminOptions","setAdminOptions","useState","getOptions","then","res","log","columns","title","dataIndex","key","render","_","data","display","vehicleId","status","pathname","state","permitId","_id","filteredValue","useSearchColumn","adminId","buildFilter","timeFrom","dayjs","format","buildTimeRangeFilter","timeTo","menu"],"mappings":"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"}